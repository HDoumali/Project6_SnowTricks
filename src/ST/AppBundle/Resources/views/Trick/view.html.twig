{% extends "STAppBundle::layout.html.twig" %}

{% block title %}
	Figure - {{ trick.name }} - {{ parent() }}
{% endblock %}

{% block body %}

<div class="container" id="trick">
<div class="thumbnail">
<div class="img_presentation_trick">
	{% for picture in trick.pictures %}
		{% if loop.first %}
			    <div class="setting_trick">
				    <a href="{{ path('st_app_edit', {'id': trick.id}) }}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
	                <a href="{{ path('st_app_delete', {'id': trick.id}) }}"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                </div>
				<img src="{{ asset(picture.webPath) }}" class="img-responsive" alt="{{ picture.alt }}">
		{% endif %}
	    {% else %}
	    	    <div class="setting_trick">
				    <a href="{{ path('st_app_edit', {'id': trick.id}) }}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
	                <a href="{{ path('st_app_delete', {'id': trick.id}) }}"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                </div>
	    	    <img src="{{ asset('img/default.jpg') }}" class="img-responsive "alt="imgdefault">
	{% endfor %}
</div>

<div class="presentation_trick">
	<h1>{{ trick.name|capitalize }}</h1>
	<br />

	{% if trick.pictures is not empty %}
		<div class="row">
			{% for picture in trick.pictures %}
				{% if not loop.first %}
					<div class="col-xs-12 col-md-3 picture">
							<img src="{{ asset(picture.webPath) }}" class="img-responsive" alt="{{ picture.alt }}">
				    </div>
				{% endif %}
			{% endfor %}
	    </div>
	{% else %}
		<p>Pas d'image.</p>
	{% endif %}
	<br />

	{% if trick.videos is not empty %}
			{% for video in trick.videos %}
					<iframe width="500" height="255" src="{{ video.link }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
			{% endfor %}
	{% else %}
		<p>Pas de video.</p>
	{% endif %}
</div>

<div class="description_trick">
	<p>{{ trick.description }}</p>
</div>

<div class="information_trick">
	{% if trick.category is not null %}
		<p>Catégorie : <em><button type="button" class="btn" id="btn_category">{{ trick.category.name }}</button></em></p>
	{% else %}
		<p>Pas de catégorie</p>
	{% endif %}
</div>
<br />

<h4><i class="far fa-2x fa-comment-alt"></i> Ajouter un commentaire</h4>

<div class="form_comment">
	<div class="well">
		  {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
		  {{ form_errors(form) }}

		  <div class="form-group">
			    {{ form_label(form.content, "Message", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
			    {{ form_errors(form.content) }}
			    <div class="col-sm-10">
			      	{{ form_widget(form.content, {'attr': {'class': 'form-control'}}) }}
			    </div>
		  </div>

		  {{ form_rest(form) }}
		  {{ form_widget(form.Ajouter, {'attr': {'class': 'btn btn-primary'}}) }}
		  {{ form_end(form) }}
	</div>

	<p><span class="label label-info">Info</span> Ce commentaire sera ajouté directement à l'espace de discussion.</p>
</div>

<div>
    {% for message in app.session.flashbag.get('message') %}
		<div class="alert alert-success" role="alert">{{ message }}</div>
		<!--<p>Message flash :</p>-->
    {% endfor %}
</div>

<h4><i class="far fa-2x fa-comments"></i> Espace de discussion </h4>

<div class="list_comment">
	{% for comment in listComments %}
		<!--<div class="thumbnail">-->
			<div class="row">
				<div class="col-xs-4 col-sm-3 col-md-3 col-lg-2">
					<img src="{{ asset(comment.user.picture.webPath) }}" class="img-responsive" alt="{{ comment.user.picture.alt }}">
				</div>
		        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-10">
				        <h5><strong>{{ comment.user.firstname }} {{ comment.user.lastname }}</strong> </h5>
				        <span>Le <em>{{ comment.date|date('d/m/Y') }}</em></span>
				        <hr>
						<p>{{ comment.content }} </p>
		        </div>
	        </div>
		<!--</div>-->
	{% else %}
		<p>Pas de commentaire.</p>
	{% endfor %}
</div>

<ul class="pagination">
  {# On utilise la fonction range(a, b) qui crée un tableau de valeurs entre a et b #}
  	{% if nbPages > 1 %}
	  	<ul class="pagination">
		  	{% for p in range(1, nbPages) %}
			    <li{% if p == page %} class="active"{% endif %}>
			      <a href="{{ path('st_app_view', {'slug': trick.slug, 'page': p}) }}">{{ p }}</a>
			    </li>
		    {% endfor %}
	    </ul>
    {% endif %}
  


</div>
</div>

{% endblock %}

