{% extends "STAppBundle::layout.html.twig" %}

{% block title %}
	Figure - {{ trick.name }} - {{ parent() }}
{% endblock %}

{% block body %}

<div class="img_presentation_trick">
	{% for picture in trick.pictures %}
		{% if loop.first %}
				<img src="{{ asset(picture.webPath) }}" alt="{{ picture.alt }}">
		{% endif %}
	    {% else %}
	    	<img src="{{ asset('img/default.jpg') }}" alt="imgdefault">
	{% endfor %}
</div>

<div class="container">
<a href="{{ path('st_app_edit', {'id': trick.id}) }}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
<a href="{{ path('st_app_delete', {'id': trick.id}) }}"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>

<h1>{{ trick.name }}</h1>

<p>{{ trick.description }}</p>

{% if trick.category is not null %}
	<p>{{ trick.category.name }}</p>
{% else %}
	<p>Pas de catégorie</p>
{% endif %}

{% if trick.pictures is not empty %}
	<div class="row">
		{% for picture in trick.pictures %}
			<div class="col-md-2 col-sm-4">
				<div class="thumbnail">
					<img src="{{ asset(picture.webPath) }}" alt="{{ picture.alt }}">
				</div>
		    </div>
		{% endfor %}
    </div>
{% else %}
	<p>Pas d'image</p>
{% endif %}

{% if trick.videos is not empty %}
	{% for video in trick.videos %}
            <iframe width="280" height="160" src="{{ video.link }}" frameborder="0" allowfullscreen></iframe>
	{% endfor %}
{% else %}
	<p>Pas de video</p>
{% endif %}

<h3>Ajouter un commentaire</h3>

 <div class="well">
  {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
  {{ form_errors(form) }}

  <div class="form-group">
	    {{ form_label(form.content, "Message", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
	    {{ form_errors(form.content) }}
	    <div class="col-sm-10">
	      {{ form_widget(form.content, {'attr': {'class': 'form-control'}}) }}
	    </div>
  </div>

  {{ form_rest(form) }}
  {{ form_widget(form.Ajouter, {'attr': {'class': 'btn btn-primary'}}) }}
  {{ form_end(form) }}
</div>

<p>Ce commentaire sera ajoutée directement à l'espace de discussion</p>

<div>
    {% for message in app.session.flashbag.get('message') %}
		<p>Message flash : {{ message }}</p>
    {% endfor %}
</div>

<h3>Espace de discussion </h3>

{% for comment in listComments %}
	<div class="row thumbnail">
		<div class="col-lg-2">
			<img src="{{ asset(comment.user.picture.webPath) }}" alt="{{ comment.user.picture.alt }}" style="width: 100%" >
		</div>
        <div class="col-lg-10">
	        <p>le {{ comment.date|date('d/m/Y') }} par {{ comment.user.firstname }} {{ comment.user.lastname }} </p>
			<p>{{ comment.content }} </p>
        </div>
	</div>
{% else %}
	<p>Pas de commentaire.</p>
{% endfor %}

</div>

{% endblock %}

